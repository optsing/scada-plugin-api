!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.PluginApi=n():e.PluginApi=n()}(window,(function(){return function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(n){return e[n]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";t.r(n),t.d(n,"isInIframe",(function(){return s})),t.d(n,"addListener",(function(){return l})),t.d(n,"getCurrentUser",(function(){return f})),t.d(n,"sendNotifi",(function(){return _})),t.d(n,"sendCommand",(function(){return v})),t.d(n,"loadTextFile",(function(){return p})),t.d(n,"saveTextFile",(function(){return m})),t.d(n,"loadJSONFile",(function(){return g})),t.d(n,"saveJSONFile",(function(){return w})),t.d(n,"loadDevicesDefinitions",(function(){return b})),t.d(n,"saveDeviceDefinition",(function(){return y})),t.d(n,"saveDeviceDescription",(function(){return h})),t.d(n,"saveDeviceTileVariables",(function(){return D})),t.d(n,"saveDeviceCommands",(function(){return S})),t.d(n,"loadDevicesData",(function(){return x})),t.d(n,"loadDeviceData",(function(){return j})),t.d(n,"updateCache",(function(){return P})),t.d(n,"saveSection",(function(){return O})),t.d(n,"addSection",(function(){return M})),t.d(n,"removeSection",(function(){return T})),t.d(n,"loadSection",(function(){return C})),t.d(n,"loadSections",(function(){return F})),t.d(n,"navigateTo",(function(){return k})),t.d(n,"addToMailing",(function(){return A})),t.d(n,"removeFromMailing",(function(){return N})),t.d(n,"identify",(function(){return J})),t.d(n,"getPosition",(function(){return U})),t.d(n,"loadSettings",(function(){return q})),t.d(n,"updateUrl",(function(){return E}));const i=window.location!==window.parent.location,r={},o={};let d,u;function s(){return i}function a(e,n){if(i){const t=e+Math.random().toString(36).substring(2),i=new Promise((e,n)=>{o[t]={resolve:e,reject:n}});return function(e,n,t=""){window.parent.postMessage({type:"PluginApi",method:e,tag:t,data:n},"*")}(e,n,t),i}return Promise.reject(new Error("Plugin Api: Not in iframe"))}function c(e,n,t,i){e in r?r[e](t,i,n):function(e,n,t){e in o&&(n?o[e].reject(n):o[e].resolve(t),delete o[e])}(n,t,i)}function l(e,n){r[e]=n}function f(){return a("getCurrentUser")}function _(e){return a("notifi",e)}function v(e,n,t){return a("sendCommand",{dev_id:e,command:n,argument:t})}function p(e){return a("readFile",{filename:e})}function m(e,n,t=!1){return a("writeFile",{filename:e,is_overwrite:t,content:n})}async function g(e,n=JSON){const t=await p(e);return n.parse(t)}function w(e,n,t=!1){return m(e,JSON.stringify(n,null,4),t)}function b(){return a("getDevicesDefinitions")}function y(e,{title:n=e,section:t="unsorted",status_variable:i="",mnemo:r="",url:o="",bg_image:d="",plugins:u=[]}={}){return a("saveDeviceDefinitionAdvanced",{dev_id:e,title:n,section:t,status_variable:i,mnemo:r,url:o,bg_image:d,plugins:u})}function h(e,{system:n="",model:t="",location:i="",service:r="",description:o="",additional:d=""}){return a("saveDeviceDescription",{dev_id:e,system:n,model:t,location:i,service:r,description:o,additional:d})}function D(e,n){return a("saveDeviceTileVariables",{dev_id:e,variable_ids:n})}function S(e,n){return a("saveDeviceCommands",{dev_id:e,variable_ids:n})}function x(){return a("getDevicesData")}function j(e){return a("getDeviceData",{dev_id:e})}function P(e="",n=!1){return a("updateCache",{path:e,replace_history:n})}function O({id:e="",old_id:n="",title:t="",subtitle:i="",icon:r="",mnemo:o="",view:d="tiles_mnemo",linked_dev_id:u="",use_dev_state:s=!1,subtitle_prop:c="_service",is_uncollapsed:l=!0,is_mixed:f=!1,is_hidden_sidebar:_=!1,parents:v=["root"],children:p=[],sorting:m=[],slideshow:g=[],owners:w=[],slideshow_width:b=50}={}){return a("saveSection",{id:e,old_id:n,title:t,subtitle:i,icon:r,mnemo:o,view:d,linked_dev_id:u,use_dev_state:s,subtitle_prop:c,is_uncollapsed:l,is_mixed:f,is_hidden_sidebar:_,parents:v,children:p,sorting:m,slideshow:g,owners:w,slideshow_width:b})}function M({id:e="",title:n="",subtitle:t="",icon:i="",mnemo:r="",view:o="tiles_mnemo",linked_dev_id:d="",use_dev_state:u=!1,subtitle_prop:s="_service",is_uncollapsed:c=!0,is_mixed:l=!1,is_hidden_sidebar:f=!1,parents:_=["root"],children:v=[],sorting:p=[],slideshow:m=[],owners:g=[],slideshow_width:w=50}={}){return a("addSection",{id:e,title:n,subtitle:t,icon:i,mnemo:r,view:o,linked_dev_id:d,use_dev_state:u,subtitle_prop:s,is_uncollapsed:c,is_mixed:l,is_hidden_sidebar:f,parents:_,children:v,sorting:p,slideshow:m,owners:g,slideshow_width:w})}function T(e){return a("removeSection",{id:e})}function C(e){return a("getSection",{id:e})}function F(){return a("getSections")}function k(e,{query:n={},replace_history:t=!1}={}){return a("navigateTo",{path:e,query:n,replace_history:t})}function A(e,n){return a("addToMailing",{mail_id:e,device_ids:n})}function N(e,n){return a("removeFromMailing",{mail_id:e,device_ids:n})}async function J(){const e=await a("identify");d=e.identify_token,u=e.position}async function U(){return u||await J(),u}async function q(){return d||await J(),a("loadSettings",{identify_token:d})}async function E({path:e,device_id:n}){return d||await J(),a("updateUrl",{path:e,device_id:n,identify_token:d})}window.addEventListener("message",e=>{"PluginApi"===e.data.type&&e.data.response&&c(e.data.method,e.data.tag,e.data.error,e.data.result)})}])}));